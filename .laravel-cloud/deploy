#!/bin/bash

# Laravel Cloud Deploy Script
echo "ğŸš€ Starting Laravel Cloud deployment..."

# Install Composer dependencies
echo "ğŸ“¦ Installing PHP dependencies..."
composer install --no-dev --optimize-autoloader

# Install NPM dependencies
echo "ğŸ“¦ Installing JS dependencies..."
npm ci

# Build assets with Vite (IMPORTANTE: Esto compila con terser)
echo "ğŸ”¨ Building production assets..."
npm run build

# Run migrations
echo "ğŸ—„ï¸  Running migrations..."
php artisan migrate --force

# Clear and cache config
echo "âš¡ Optimizing application..."
php artisan config:cache
php artisan route:cache
php artisan view:cache

# Storage link
echo "ğŸ”— Creating storage link..."
php artisan storage:link

echo "âœ… Deployment completed successfully!"

